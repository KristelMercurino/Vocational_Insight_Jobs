docker build -t gcr.io/vocational-insight-api/laborum-scraper-subareas:latest .
docker push gcr.io/vocational-insight-api/laborum-scraper-subareas:latest

gcloud beta run jobs create laborum-subareas-job `
    --image gcr.io/vocational-insight-api/laborum-scraper-subareas:latest `
    --region southamerica-east1 `
    --set-env-vars "DB_USER=vi_dev,DB_PASS=}9$agO3IU.A2RJZ2,DB_HOST=3.238.81.238,DB_PORT=3306,DB_NAME=vocational_insight_model,PLAYWRIGHT_HEADLESS=True" `
    --memory 1024Mi `
    --task-timeout 900s

gcloud scheduler jobs create pubsub laborum-subareas-job-scheduler `
    --schedule="0 22 1 * *" `
    --time-zone="America/Santiago" `
    --description="Ejecutar el job de sub√°reas de Laborum" `
    --topic=cloud-run-job-topic `
    --message-body='{}' `
    --location=southamerica-east1

gcloud pubsub topics create cloud-run-job-topic

gcloud scheduler jobs list --location=southamerica-east1

gcloud scheduler jobs describe laborum-subareas-job-scheduler --location=southamerica-east1

gcloud beta run jobs run laborum-subareas-job `
    --region=southamerica-east1 `
    --format=json | jq '.name' | xargs -I {} gcloud pubsub subscriptions create run-job-subscription `
    --topic=cloud-run-job-topic `
    --ack-deadline=30 `
    --push-endpoint={} `
    --push-auth-service-account=k.mercurino@duocuc.cl
